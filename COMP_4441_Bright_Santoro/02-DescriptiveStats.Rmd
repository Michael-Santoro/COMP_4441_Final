# Descriptive Statistics

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(ggpubr)
library(boot)
library("Hmisc")
library(corrplot)
library("PerformanceAnalytics")
library(pastecs)
library(ggplot2)
library(class)
library(caret)
library(randomForest)
library(plyr)
library(quantreg)
library(glmnet)
```


## Dataset

<<<<<<< HEAD
The dataset utilized for our analysis was collected from the UCI Machine Learning Repository @model_wine. The dataset consists of 12 elements, 11 physiochemical properties and 1 subjective quality measurement, for both red and white Vinho Verde wine samples from Portugal.
=======
The dataset utilized for our analysis was collected from the UCI Machine Learning Repository @dataset. The dataset consists of 12 elements, 11 physiochemical properties and 1 subjective quality measurement, for both red Vinho Verde wine samples from Portugal.
>>>>>>> c6ba8f8fb2255ffc2bbc363a5f68884fb9ea5b13


**Read in Data**

```{r}
redWine<-read.table("data/winequality-red.csv",stringsAsFactors = FALSE,
                sep=",",header = TRUE)
whiteWine<-read.table("data/winequality-white.csv",stringsAsFactors = FALSE,
                sep=";",header = TRUE)

# create a field that shows whether a wine is red or white based on initial 
# datasets
redWine$type='red'
whiteWine$type='white'

# merge data
wine <- rbind(redWine, whiteWine)

str(wine)
```

The table above shows the structure of our dataset before any sort of data manipulation, munging, or cleaning. 

## Exploratory Analysis

### Descriptive Statistics

<<<<<<< HEAD
In order to better understand our data set we performed some initial descriptive statistics. A descriptive statistic is a summary level statistic, such as mean or median, that describes a variable or feature of a dataset. Descriptive statistics is the processing of analyzing the descriptive statistic taken from your dataset. @descrip_stat
=======
In order to better understand our dataset we performed some initial descriptive statistics. A descriptive statistic is a summary level statistic, such as mean or median, that describes a variable or feature of a dataset. Descriptive statistics is the processing of analyzing the descriptive statistic taken from your dataset. @descrip_stat
>>>>>>> c6ba8f8fb2255ffc2bbc363a5f68884fb9ea5b13

The table below shows descriptive statistic measurements for each of the variables in our dataset. 

```{r}
stat.desc(wine)
```

***Univariate Exploration***

Univariate exploration explores each variable one by one. We can use univariate exploration to explore the distribution of a single variable or desriptive statistic. 

The variables for the three plots below were selected judgmentally from the dataset. 

```{r}

mu <- ddply(wine, "type", summarise, grp.mean=mean(alcohol))

p<-ggplot(wine, aes(x=alcohol, fill=type, color=type)) +
  geom_histogram(position="dodge")+
  theme(legend.position="top") + 
  geom_vline(data=mu, aes(xintercept=grp.mean, color=type),
             linetype="dashed")+
  theme(legend.position="top")

p
```

The table above shows the distribution of the alcohol variable 


```{r}

mu <- ddply(wine, "type", summarise, grp.mean=mean(volatile.acidity))

p<-ggplot(wine, aes(x=volatile.acidity, fill=type, color=type)) +
  geom_histogram(position="dodge")+
  theme(legend.position="top") + 
  geom_vline(data=mu, aes(xintercept=grp.mean, color=type),
             linetype="dashed")+
  theme(legend.position="top")

p
```


```{r}

mu <- ddply(wine, "type", summarise, grp.mean=mean(density))

p<-ggplot(wine, aes(x=density, fill=type, color=type)) +
  geom_histogram(position="dodge")+
  theme(legend.position="top") + 
  geom_vline(data=mu, aes(xintercept=grp.mean, color=type),
             linetype="dashed")+
  theme(legend.position="top")

p
```

***Bivariate Exploration***
Bivariate exploration allows us to explore the relationship between two descriptive statistics in a dataset. 

To better determine which variable relationships we should explore, we ran correlation analysis.  

```{r}
# ++++++++++++++++++++++++++++
# flattenCorrMatrix
# ++++++++++++++++++++++++++++
# cormat : matrix of the correlation coefficients
# pmat : matrix of the correlation p-values
flattenCorrMatrix <- function(cormat, pmat) {
  ut <- upper.tri(cormat)
  data.frame(
    row = rownames(cormat)[row(cormat)[ut]],
    column = rownames(cormat)[col(cormat)[ut]],
    cor  =(cormat)[ut],
    p = pmat[ut]
    )
}

# exclude the type of wine from the correlation variables 
res2 <- rcorr(as.matrix(wine[,1:12]))
cor.m <- flattenCorrMatrix(res2$r, res2$P)
cor.m[order(cor.m[,3],decreasing=TRUE),]

```

***Visualize Correlations***

```{r}

# Insignificant correlations are leaved blank
corrplot(res2$r, type="upper", order="hclust", 
         p.mat = res2$P, sig.level = 0.01, insig = "blank")
```

Based on the correlation matrix and the correlation plots it appears that there is a strong negative correlation between alcohol and density and a strong positive correlation between residual sugar and density.  These are plotted below. 


```{r}

ggplot(wine, 
       aes(x = alcohol, 
           y = density, 
           color = type)) +
  geom_point(size = 3, 
             alpha = .05) +
  labs(title = "Wine Composition by alcohol, density, and type")
```
```{r}

ggplot(wine, 
       aes(x = residual.sugar, 
           y = density, 
           color = type)) +
  geom_point(size = 3, 
             alpha = .05) +
  labs(title = "Wine Composition by residual.sugar, density, and type")
```

## Test for Normality

In the tests that follow, we will want to have a normal looking distribution, and we can see from the plot below that it is Normal looking.

```{r}
g <- ggplot()+geom_freqpoly(aes(wine$quality),bins=6)
g <- g + labs(title = "Quality Normaility", x="Residual", y="Total")
g
```



