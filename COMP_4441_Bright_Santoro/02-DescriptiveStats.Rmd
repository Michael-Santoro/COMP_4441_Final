# Descriptive Statistics

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(ggpubr)
library(boot)
library("Hmisc")
library(corrplot)
library("PerformanceAnalytics")
library(pastecs)
library(ggplot2)
library(class)
library(caret)
library(randomForest)
library(plyr)
```


## Dataset

The dataset utilized for our analysis was collected from the UCI Machine Learning Repository (see References). The dataset consists of 12 elements, 11 physiochemical properties and 1 subjective quality measurement, for both red Vinho Verde wine samples from Portugal.


**Read in Data**

```{r}
redWine<-read.table("data/winequality-red.csv",stringsAsFactors = FALSE,
                sep=",",header = TRUE)
whiteWine<-read.table("data/winequality-white.csv",stringsAsFactors = FALSE,
                sep=";",header = TRUE)

redWine$type='red'
whiteWine$type='white'

# create a field that shows whether a wine is red or white based on initial 
# datasets
wine <- rbind(redWine, whiteWine)

str(wine)
```


## Exploratory Analysis

### Descriptive Statistics

In order to better understand our dataset we performed some initial descriptive statistics. A descriptive statistic is a summary level statistic, such as mean or median, that describes a variable or feature of a dataset. Descriptive statistics is the processing of analyzing the descriptive statistic taken from your dataset. (“Descriptive Statistics”)

The table below shows descriptive statistic measurements for each of the variables in our dataset. 

```{r}

stat.desc(wine)
```

***Univariate Exploration***
We can use univariate exploration to explore the distribution of a single variable or desriptive statistic. 

The variables for the three plots below were selected judgmentally from the dataset. 

```{r}

mu <- ddply(wine, "type", summarise, grp.mean=mean(alcohol))

p<-ggplot(wine, aes(x=alcohol, fill=type, color=type)) +
  geom_histogram(position="dodge")+
  theme(legend.position="top") + 
  geom_vline(data=mu, aes(xintercept=grp.mean, color=type),
             linetype="dashed")+
  theme(legend.position="top")

p
```

```{r}

mu <- ddply(wine, "type", summarise, grp.mean=mean(volatile.acidity))

p<-ggplot(wine, aes(x=volatile.acidity, fill=type, color=type)) +
  geom_histogram(position="dodge")+
  theme(legend.position="top") + 
  geom_vline(data=mu, aes(xintercept=grp.mean, color=type),
             linetype="dashed")+
  theme(legend.position="top")

p
```


```{r}

mu <- ddply(wine, "type", summarise, grp.mean=mean(density))

p<-ggplot(wine, aes(x=density, fill=type, color=type)) +
  geom_histogram(position="dodge")+
  theme(legend.position="top") + 
  geom_vline(data=mu, aes(xintercept=grp.mean, color=type),
             linetype="dashed")+
  theme(legend.position="top")

p
```

***Bivariate Exploration***
Bivariate exploration allows us to explore the relationship between two descriptive statistics in a dataset. 

To better determine which variable relationships we should explore, we ran correlation analysis.  

```{r}
# ++++++++++++++++++++++++++++
# flattenCorrMatrix
# ++++++++++++++++++++++++++++
# cormat : matrix of the correlation coefficients
# pmat : matrix of the correlation p-values
flattenCorrMatrix <- function(cormat, pmat) {
  ut <- upper.tri(cormat)
  data.frame(
    row = rownames(cormat)[row(cormat)[ut]],
    column = rownames(cormat)[col(cormat)[ut]],
    cor  =(cormat)[ut],
    p = pmat[ut]
    )
}

# exclude the type of wine from the correlation variables 
res2 <- rcorr(as.matrix(wine[,1:12]))
cor.m <- flattenCorrMatrix(res2$r, res2$P)
cor.m[order(cor.m[,3],decreasing=TRUE),]

```

***Visualize Correlations***

```{r}

# Insignificant correlations are leaved blank
corrplot(res2$r, type="upper", order="hclust", 
         p.mat = res2$P, sig.level = 0.01, insig = "blank")
```

Based on the correlation matrix and the correlation plots it appears that there is a strong negative correlation between alcohol and density and a strong positive correlation between residual sugar and density.  These are plotted below. 


```{r}

ggplot(wine, 
       aes(x = alcohol, 
           y = density, 
           color = type)) +
  geom_point(size = 3, 
             alpha = .05) +
  labs(title = "Wine Composition by alcohol, density, and type")
```
```{r}

ggplot(wine, 
       aes(x = residual.sugar, 
           y = density, 
           color = type)) +
  geom_point(size = 3, 
             alpha = .05) +
  labs(title = "Wine Composition by residual.sugar, density, and type")
```
